# name: benchmark/tpch/parquet/pixels_q${QUERY_NUMBER_PADDED}.benchmark
# description: Execute Q${QUERY_NUMBER_PADDED} over lineitem stored in a pixels file
# group: [pixels]

name Q${QUERY_NUMBER_PADDED} (Pixels)
group pixels
subgroup tpch

require pixels
require tpch

load
CREATE VIEW lineitem AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/lineitem/v-0-order/*.pxl');
CREATE VIEW nation AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/nation/v-0-order/*.pxl');
CREATE VIEW region AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/region/v-0-order/*.pxl');
CREATE VIEW supplier AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/supplier/v-0-order/*.pxl');
CREATE VIEW customer AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/customer/v-0-order/*.pxl');
CREATE VIEW part AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/part/v-0-order/*.pxl');
CREATE VIEW partsupp AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/partsupp/v-0-order/*.pxl');
CREATE VIEW orders AS SELECT * FROM pixels_scan('/data/s1725-2/liyu/pixels_data/pixels-tpch-${SF_NUMBER_UNDERSCORE}-big-endian/orders/v-0-order/*.pxl');

run extension/tpch/dbgen/queries/q${QUERY_NUMBER_PADDED}.sql

result extension/tpch/dbgen/answers/sf${SF_NUMBER}/q${QUERY_NUMBER_PADDED}.csv
